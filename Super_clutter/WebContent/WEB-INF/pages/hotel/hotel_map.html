<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<style type="text/css">
body,html,#allmap {
	width: 100%;
	height: 100%;
	overflow: hidden;
	margin: 0;
}

#l-map {
	height: 100%;
	width: 78%;
	float: left;
	border-right: 2px solid #bcbcbc;
}

#r-result {
	height: 100%;
	width: 20%;
	float: left;
}
.BMap_shadow {
	display:none;
}

</style>
<script type="text/javascript"
	src="http://api.map.baidu.com/api?v=1.5&ak=CA152fe66fe4998de14538722d67fc60"></script>
<title>酒店位置</title> <#include "../common/define.html">
</head>
<body>
<div class="lv-header lv-media-width lv-header-mheight" style="width:100%">
  <div class="lv-operate-icon lv-pull-left"> <a href="javascript:window.history.go(-1);"> <img src="http://pic.lvmama.com/img/mobile/touch/img/return.png"> </a> </div>
  <div class="lv-operate-sep lv-pull-left"><img src="http://pic.lvmama.com/img/mobile/touch/img/operate_sep.png"></div>
  <div class="lv-title">地图</div>
</div>
	<div id="allmap"></div>
</body>
</html>
<script type="text/javascript">
$(function(){
	var name = unescape(getUrlParam("name"));
	var address= unescape(getUrlParam("address"));
	var latitude = Number(getUrlParam("latitude"));
	var longitude = Number(getUrlParam("longitude"));
	
	var map = new BMap.Map("allmap");            // 创建Map实例
	var point = new BMap.Point(longitude,latitude);    // 创建点坐标
	
	map.centerAndZoom(point,16);                  // 初始化地图,设置中心点坐标和地图级别。
	var marker = new BMap.Marker(point);        // 创建标注    
	map.addOverlay(marker);
	marker.addEventListener("click", function(){  
		var opts = {  
		 width : 200     // 信息窗口宽度  
		}  
		var infoWindow = new BMap.InfoWindow("<div style='text-align:center;padding-top: 14px;font-size:1.3em;' onclick='window.history.go(-1);'><div style='font-size:1.2em;'>"+name +"</div><div>"+address+"</div></div>", opts);  // 创建信息窗口对象  
		map.openInfoWindow(infoWindow, point);      // 打开信息窗口
		$(".BMap_pop img").live($(this).hide());
	});
});

function ComplexCustomOverlay(point, text, mouseoverText){
    this._point = point;
    this._text = text;
    this._overText = mouseoverText;
  }
  ComplexCustomOverlay.prototype = new BMap.Overlay();
  ComplexCustomOverlay.prototype.initialize = function(map){
    this._map = map;
    var div = this._div = document.createElement("div");
    div.id = "mapId";
    div.style.position = "absolute";
    div.style.zIndex = BMap.Overlay.getZIndex(this._point.lat);
    div.style.color = "white";
    div.style.width = "200px";
    //div.style.height = "44px";
    div.style.padding = "2px";
    div.style.lineHeight = "18px";
    div.style.whiteSpace = "nowrap";
    div.style.MozUserSelect = "none";
    div.style.fontSize = "12px"
    div.style.textAlign = "center";
    
    var overlayDiv = document.createElement("div");
    overlayDiv.style.background = "url(${prefix_pic_url!}/img/position-overlay-next.png) no-repeat 95% center";
    overlayDiv.style.backgroundColor = "#242424";
    overlayDiv.style.opacity = "0.85";
    overlayDiv.style.lineHeight = "1.5em";
    overlayDiv.style.padding = "6px 6px";
    $(overlayDiv).css("border-radius","4px");
    div.appendChild(overlayDiv);
    var span = this._span = document.createElement("div");
    overlayDiv.appendChild(span);
    span.innerHTML = this._text;
    var that = this;

    var arrow = this._arrow = document.createElement("div");
    arrow.style.background = "url(${prefix_pic_url!}/img/position-overlay-narrow.png) no-repeat";
    arrow.style.position = "absolute";
    arrow.style.opacity = "1.0";
    arrow.style.width = "10px";
    arrow.style.height = "7px";
    arrow.style.top = "50px";
    arrow.style.left = "102px";
    arrow.style.overflow = "hidden";
    div.appendChild(arrow);
    
    map.getPanes().labelPane.appendChild(div);
    
    return div;
  }
  ComplexCustomOverlay.prototype.draw = function(){
    var map = this._map;
    var pixel = map.pointToOverlayPixel(this._point);
    this._div.style.left = pixel.x - 108 + "px";
    this._div.style.top  = pixel.y - 78 + "px";
  }
  

</script>
