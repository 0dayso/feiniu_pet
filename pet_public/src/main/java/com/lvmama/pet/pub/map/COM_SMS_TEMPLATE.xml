<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="COM_SMS_TEMPLATE">
	<resultMap id="BaseResultMap" class="com.lvmama.comm.pet.po.pub.ComSmsTemplate">
		<!-- WARNING - This element is automatically generated by Apache iBATIS 
			ibator, do not modify. This element was generated on Tue Apr 20 11:55:56 
			CST 2010. -->
		<result column="TEMPLATE_ID" property="templateId" />
		<result column="TEMPLATE_NAME" property="templateName" />
		<result column="CONTENT" property="content" />
		<result column="IMMEDIATELY" property="immendiately" />
		<result column="CHANNLE_ID" property="channelId" />
		<result column="CHANNEL_TYPE" property="channelId" />
		<result column="VALID" property="valid" />
		<result column="CREATE_TIME" property="createTime" />
		<result column="TEMPLATE_TYPE" property="templateType" />
		<result column="CHANNEL" property="channel" />
		<result column="CHANNEL_CMCC" property="channelCMCC" />
		<result column="CHANNEL_CUC" property="channelCUC" />
		<result column="CHANNEL_CT" property="channelCT" />
	</resultMap>

	<select id="selectAll" resultMap="BaseResultMap" parameterClass="java.util.HashMap">
		select * from COM_SMS_TEMPLATE CT where 1=1
		<isNotEmpty property="templateType" prepend="AND">
			CT.TEMPLATE_TYPE = #templateType#
		</isNotEmpty>
	</select>

	<select id="selectByPrimaryKey" resultMap="BaseResultMap"
		parameterClass="com.lvmama.comm.pet.po.pub.ComSmsTemplate">
		select *
		from COM_SMS_TEMPLATE
		where TEMPLATE_ID = #templateId#
	</select>
	
	<delete id="deleteByPrimaryKey" parameterClass="com.lvmama.comm.pet.po.pub.ComSmsTemplate">
		delete from COM_SMS_TEMPLATE
		where TEMPLATE_ID = #templateId#
	</delete>
	
	<insert id="insert" parameterClass="com.lvmama.comm.pet.po.pub.ComSmsTemplate">
		insert into com_sms_template
		(template_id, template_name, content, immediately, channle_id, channel_type, valid,
		create_time, template_type, channel, channel_cmcc, channel_cuc,
		channel_ct)
		values
		(#templateId#, #templateName#, #content#, #immendiately#, #channelId#,
		#channelType#, #valid#, sysdate, #templateType#, #channel#,
		#channelCMCC#, #channelCUC#, #channelCT#)
	</insert>
	
	<update id="updateByPrimaryKey" parameterClass="com.lvmama.comm.pet.po.pub.ComSmsTemplate">
		update com_sms_template
		set template_name = #templateName#,
		content = #content#,
		immediately = #immendiately#,
		channle_id = #channelId#,
		channel_type = #channelType#,
		valid = #valid#,
		template_type = #templateType#,
		channel = #channel#,
		channel_cmcc = #channelCMCC#,
		channel_cuc = #channelCUC#,
		channel_ct = #channelCT#
		where template_id = #templateId#
	</update>
	
	<sql id="selectSqlWhere">
		<dynamic prepend="where">
			<isNotEmpty property="templateId" prepend="and">
				t.TEMPLATE_ID =
				#templateId#
			</isNotEmpty>
			<isNotEmpty property="templateName" prepend="and">
				t.TEMPLATE_NAME like '%$templateName$%'
			</isNotEmpty>
			<isNotEmpty property="content" prepend="and">
				t.CONTENT like '%$content$%'
			</isNotEmpty>
			<isNotEmpty property="channelWhere" prepend="and">
				t.channel = #channelWhere#
			</isNotEmpty>
			<isNotEmpty property="channelCMCCWhere" prepend="and">
				t.channel_cmcc = #channelCMCCWhere#
			</isNotEmpty>
			<isNotEmpty property="channelCUCWhere" prepend="and">
				t.channel_cuc = #channelCUCWhere#
			</isNotEmpty>
			<isNotEmpty property="channelCTWhere" prepend="and">
				t.channel_ct = #channelCTWhere#
			</isNotEmpty>
		</dynamic>
	</sql>
	<sql id="selectSql">
		select *
		from COM_SMS_TEMPLATE t
		<include refid="selectSqlWhere"/>
	</sql>

	<select id="getListByParams" parameterClass="java.util.Map"
		resultMap="BaseResultMap">
		SELECT * FROM (
		SELECT T.*, ROWNUM AS ROWNUM1 FROM ( select * from (

		<include refid="selectSql" />

		)) T 
		<dynamic prepend="where">
			<isNotEmpty property="maxResults">
			ROWNUM &lt;= #maxResults#
			</isNotEmpty>
		</dynamic>
		)
		<dynamic prepend="where">
			<isNotEmpty property="skipResults">
			ROWNUM1 &gt;#skipResults#
			</isNotEmpty>
		</dynamic>
	</select>

	<select id="getListCountByParams" resultClass="java.lang.Long"
		parameterClass="java.util.Map">
		select count(*) from
		(
		<include refid="selectSql" />
		)
	</select>
	
	<!-- 修改渠道 -->
	<update id="updateChannelByMap" parameterClass="java.util.Map">
		update com_sms_template t
		<dynamic prepend="set">
			<isEqual prepend="," property="channel" compareValue="THESAME">
				channel = channel
			</isEqual>
			<isNotEqual prepend="," property="channel" compareValue="THESAME">
				channel = #channel#
			</isNotEqual>
			<isEqual prepend="," property="channelCMCC" compareValue="THESAME">
				channel_cmcc = channel_cmcc
			</isEqual>
			<isNotEqual prepend="," property="channelCMCC" compareValue="THESAME">
				channel_cmcc = #channelCMCC#
			</isNotEqual>
			<isEqual prepend="," property="channelCUC" compareValue="THESAME">
				channel_cuc = channel_cuc
			</isEqual>
			<isNotEqual prepend="," property="channelCUC" compareValue="THESAME">
				channel_cuc = #channelCUC#
			</isNotEqual>
			<isEqual prepend="," property="channelCT" compareValue="THESAME">
				channel_ct = channel_ct
			</isEqual>
			<isNotEqual prepend="," property="channelCT" compareValue="THESAME">
				channel_ct = #channelCT#
			</isNotEqual>
		</dynamic>
		<include refid="selectSqlWhere"/>
	</update>
</sqlMap>